"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[204],{4235:(e,t,r)=>{r.d(t,{Z:()=>c});var a=r(890),o=r(3400),s=r(7391),i=r(4294),n=r(3239),l=r(2791),d=r(184);const c=e=>{let{close:t,type:r,resetEmail:c,startCountdown:h,countdown:m,isButtonDisabled:u}=e;const[x,p]=(0,l.useState)(c||""),[g,j]=(0,l.useState)(""),[v,y]=(0,l.useState)(!1),[Z,f]=(0,l.useState)({});return(0,d.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"300px",height:"410px",backgroundColor:"white",bgcolor:"background.paper",borderRadius:"5px",border:"0.1px solid black"},children:[(0,d.jsx)(a.Z,{sx:{backgroundColor:"#0F75E0",padding:2,color:"white",pb:2},variant:"h5",align:"center",children:"change"===r?"Reset Password":" Forgot Password"}),(0,d.jsx)(o.Z,{style:{transform:"translate(240px, -60px)",color:"#282F48"},onClick:()=>t(!1),children:(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",height:"40",width:"40",children:(0,d.jsx)("path",{d:"m10.458 31.458-1.916-1.916 9.5-9.542-9.5-9.542 1.916-1.916 9.542 9.5 9.542-9.5 1.916 1.916-9.5 9.542 9.5 9.542-1.916 1.916-9.542-9.5Z"})})}),(0,d.jsx)("div",{}),(0,d.jsxs)(a.Z,{mb:4,mt:{sm:-3,md:0},textAlign:"center",variant:"body2",children:["Send a link to reset  ",(0,d.jsx)("br",{}),"  your password"]}),(0,d.jsxs)("div",{style:{padding:10},children:[(0,d.jsx)(s.Z,{id:"email-reset",type:"email",autoComplete:"email",label:"Email Address",disabled:"change"===r,value:"change"===r?c:x,onChange:e=>p(e.target.value),required:!0,fullWidth:!0,error:!!Z.email,helperText:Z.email||"",name:"email"}),g&&(0,d.jsxs)("h3",{style:{textAlign:"center",color:"#30842E",marginTop:"5px"},children:[g,"!"]}),(0,d.jsx)(i.Z,{variant:"outlined",color:"secondary",fullWidth:!0,onClick:async e=>{if(f({}),""!==x.trim()){if(!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(x.trim()))return void f((e=>({...e,email:"Please enter a valid email address"})));e.preventDefault();try{y(!0);const e=await fetch("http://localhost:8000/api/forgot-password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:x})}),t=await e.json();e.ok&&(y(!1),j(t.message),h()),429===e.status?f({email:e.statusText}):t.errors&&t.errors.email?f({email:t.errors.email}):j(t.message||"Error occurred")}catch(t){y(!1),f({message:t.message})}finally{y(!1)}}else f((e=>({...e,email:"Email is required"})))},disabled:u||v,type:"submit",sx:{mt:8,height:"50px"},children:v?(0,d.jsx)(n.Z,{size:24}):u?"Resend Link (".concat(m,")"):"Send Link"})]})]})}},4204:(e,t,r)=>{r.r(t),r.d(t,{default:()=>w});var a=r(2791),o=r(7689),s=r(9165),i=r(1889),n=r(890),l=r(5527),d=r(4721),c=r(3239),h=r(7391),m=r(4294),u=r(6029),x=r(8447),p=r(5289),g=r(5661),j=r(9157),v=r(1691),y=r(7123),Z=r(2019),f=r(4235),b=r(184);const w=()=>{(0,a.useEffect)((()=>{document.title="Your Account Details - Herba Natural User Profile",document.querySelector('meta[name="description"]').setAttribute("content","Manage your Herba Natural account details. Update personal information, track orders, and customize your CBD shopping experience.")}),[]);const{deleteUser:e}=(0,Z.a)(),[t,r]=(0,a.useState)(null),[w,C]=(0,a.useState)(!1),[S,k]=(0,a.useState)(!1),[N,A]=(0,a.useState)({}),[P,E]=(0,a.useState)(!1),T=(0,o.s0)(),[D,W]=(0,a.useState)(!1),[B,z]=(0,a.useState)(!1),[F,M]=(0,a.useState)(30),[O,U]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=localStorage.getItem("token");if(e){const t=(0,s.o)(e).customerId;H(t)}else T("/login")}),[T]);const H=async e=>{k(!0);try{const t=await fetch("http://localhost:8000/api/customer/".concat(e),{credentials:"include"});if(!t.ok)throw new Error("Network response was not ok");const a=await t.json();if(r(a),a.orders&&a.orders.length>0){const e=await(async e=>(await Promise.all(e.map((e=>fetch("http://localhost:8000/api/order/".concat(e),{credentials:"include"}).then((e=>e.json())).catch((t=>{console.error("Error fetching order:",e,t)})))))).filter((e=>null!=e)))(a.orders);r((t=>({...t,orders:e})))}}catch(t){console.error("Error fetching customer data:",t)}finally{k(!1)}},L=e=>{r({...t,[e.target.name]:e.target.value}),E(!0)},V=()=>{W(!1)};return S?(0,b.jsx)(l.Z,{sx:{p:2,maxWidth:800,margin:"0 auto",marginTop:4},children:(0,b.jsxs)(n.Z,{variant:"h5",sx:{marginBottom:2},children:["Loading Account Details...",(0,b.jsx)(c.Z,{})]})}):(0,b.jsxs)(l.Z,{sx:{p:4,maxWidth:800,margin:"0px auto",marginTop:5,marginBottom:5},children:[(0,b.jsx)(n.Z,{variant:"h1",component:"h1",sx:{marginBottom:2,fontSize:"h5.fontSize"},children:"Account Details"}),(0,b.jsx)("form",{onSubmit:async e=>{e.preventDefault(),A({}),C(!0);try{const e=await fetch("http://localhost:8000/api/customer/".concat(t._id),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(e.ok){const t=await e.json();r(t),C(!1),E(!1),window.alert("Account Succssfully Updated!")}else{const t=await e.json();if(console.error("Error updating customer data:",t),"Validation error"===t.message&&t.error){const e={};Object.keys(t.error.errors).forEach((r=>{console.error("Validation error for ".concat(r,": ").concat(t.error.errors[r].message)),e[r]=t.error.errors[r].message})),A(e),C(!1)}}}catch(a){console.error("Unknown error occurred:",a)}finally{C(!1)}},children:(0,b.jsxs)(i.ZP,{container:!0,spacing:2,children:[(0,b.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,b.jsx)(h.Z,{autoComplete:"given-name",name:"firstName",label:"First Name",fullWidth:!0,value:(null===t||void 0===t?void 0:t.firstName)||"",onChange:L,error:!!N.firstName,helperText:N.firstName})}),(0,b.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,b.jsx)(h.Z,{label:"Last Name",fullWidth:!0,autoComplete:"family-name",name:"lastName",value:(null===t||void 0===t?void 0:t.lastName)||"",onChange:L,error:!!N.lastName,helperText:N.lastName})}),(0,b.jsx)(i.ZP,{item:!0,xs:12,children:(0,b.jsx)(h.Z,{label:"Email",fullWidth:!0,autoComplete:"email",type:"email",id:"email",name:"email",value:(null===t||void 0===t?void 0:t.email)||"",onChange:L,error:!!N.email,helperText:N.email?N.email:(0,b.jsxs)("span",{children:[(0,b.jsx)("svg",{height:"16",fill:"#0F75E0",style:{transform:"translateY(3px)"},viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM11 7H13V9H11V7ZM11 11H13V17H11V11Z"})})," This will change the email associated with your account"]})})}),(0,b.jsx)(i.ZP,{item:!0,xs:12,children:(0,b.jsx)(h.Z,{label:"Address",fullWidth:!0,name:"address1",autoComplete:"address-line1",value:(null===t||void 0===t?void 0:t.address)||"",onChange:L})}),(0,b.jsx)(i.ZP,{item:!0,xs:12,children:(0,b.jsx)(h.Z,{label:"Address Line 2",fullWidth:!0,autoComplete:"address-line2",name:"address2",value:(null===t||void 0===t?void 0:t.address2)||"",onChange:L})}),(0,b.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,b.jsx)(h.Z,{label:"City",fullWidth:!0,name:"city",autoComplete:"address-level2",value:(null===t||void 0===t?void 0:t.city)||"",onChange:L})}),(0,b.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,b.jsx)(h.Z,{label:"State",fullWidth:!0,name:"state",autoComplete:"address-level1",value:(null===t||void 0===t?void 0:t.state)||"",onChange:L})}),(0,b.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,b.jsx)(h.Z,{label:"Zip",fullWidth:!0,name:"zip",autoComplete:"postal-code",value:(null===t||void 0===t?void 0:t.zip)||"",onChange:L})}),(0,b.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,b.jsx)(h.Z,{label:"Phone",fullWidth:!0,name:"phone",type:"tel",autoComplete:"tel",value:(null===t||void 0===t?void 0:t.phone)||"",onChange:L})}),(0,b.jsx)(i.ZP,{item:!0,xs:12,children:(0,b.jsx)(h.Z,{autoComplete:"country-name",label:"Country",fullWidth:!0,name:"country",value:(null===t||void 0===t?void 0:t.country)||"",onChange:L})}),(0,b.jsxs)(i.ZP,{item:!0,xs:12,children:[(0,b.jsx)(n.Z,{variant:"body2",align:"center",mt:2,children:(0,b.jsx)(m.Z,{type:"button",onClick:()=>z(!0),color:"primary",children:"Change your password?"})}),(0,b.jsxs)(u.Z,{sx:{marginTop:2,height:"90px",display:"flex",justifyContent:"space-between",alignItems:"center",flexDirection:{xs:"column",sm:"row"}},children:[(0,b.jsx)(m.Z,{style:{width:"210px"},disabled:w||!P,variant:"contained",color:"primary",type:"submit",children:w?(0,b.jsx)(c.Z,{size:24}):"Save Changes"}),(0,b.jsx)(m.Z,{style:{width:"210px"},variant:"contained",color:"error",onClick:()=>{W(!0)},children:"Delete Account"})]}),(0,b.jsx)(x.Z,{open:B,onClose:()=>z(!1),"aria-labelledby":"forgot-password-modal","aria-describedby":"forgot-password-form",children:(0,b.jsx)("div",{children:(0,b.jsx)(f.Z,{close:z,type:"change",resetEmail:null===t||void 0===t?void 0:t.email,startCountdown:()=>{U(!0),M(30);const e=setInterval((()=>{M((t=>t<=1?(clearInterval(e),U(!1),0):t-1))}),1e3)},isButtonDisabled:O,countdown:F})})}),(0,b.jsx)(n.Z,{variant:"h1",component:"h1",sx:{marginBottom:2,fontSize:"h5.fontSize",mt:10},children:"Your Orders"})]}),t&&t.orders&&t.orders.length>0?t.orders.map(((e,t)=>{var r,a,o;return(0,b.jsxs)(l.Z,{sx:{padding:2,marginBottom:3,width:"100%"},children:[(0,b.jsxs)(n.Z,{variant:"h6",children:["Order #",e.orderNumber]}),(0,b.jsxs)(n.Z,{variant:"body2",children:["Order Date: ",e.orderDate?new Date(e.orderDate).toLocaleDateString():"N/A"]}),(0,b.jsxs)(n.Z,{variant:"body2",children:["Total Amount: $",e.totalAmount?e.totalAmount.grandTotal.toFixed(2):"N/A"]}),(0,b.jsxs)(n.Z,{variant:"body2",children:["Order Status: ",(null===e||void 0===e?void 0:e.orderStatus)||"Unknown"]}),(0,b.jsxs)(n.Z,{variant:"body2",children:["Payment Status: ",(null===e||void 0===e?void 0:e.paymentStatus)||"N/A"]}),(0,b.jsx)(d.Z,{sx:{my:2}}),e.shippingMethod&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(n.Z,{variant:"body2",children:["Shipping Carrier: ",(null===(r=e.shippingMethod)||void 0===r?void 0:r.carrier)||"N/A"]}),(0,b.jsxs)(n.Z,{variant:"body2",children:["Shipping To: ",e.address||"N/A"]}),(0,b.jsxs)(n.Z,{variant:"body2",children:["Tracking Number: ",(null===(a=e.shippingMethod)||void 0===a?void 0:a.trackingNumber)||"N/A"]}),(0,b.jsxs)(n.Z,{variant:"body2",children:["Track Your Package: ",(0,b.jsx)("a",{href:(null===(o=e.shippingMethod)||void 0===o?void 0:o.trackingUrl)||"#",children:"Here"})]})]}),(0,b.jsx)(d.Z,{sx:{my:2}}),e.products&&e.products.length>0?e.products.map(((e,t)=>(e=>(0,b.jsxs)(i.ZP,{container:!0,spacing:1,sx:{marginBottom:1},children:[(0,b.jsx)(i.ZP,{item:!0,xs:3,children:(0,b.jsx)("img",{src:e.img,alt:e.name,style:{width:"100%",height:"auto"}})}),(0,b.jsxs)(i.ZP,{item:!0,xs:9,children:[(0,b.jsx)(n.Z,{variant:"subtitle2",children:e.name}),(0,b.jsxs)(n.Z,{variant:"body2",children:["Price: $",e.price?e.price.toFixed(2):"N/A"]}),(0,b.jsxs)(n.Z,{variant:"body2",children:["Quantity: ",e.quantity||"N/A"]})]})]},e))(e))):(0,b.jsx)(n.Z,{variant:"body2",children:"No products in this order."}),(0,b.jsx)(d.Z,{sx:{my:2}}),e.orderNotes&&(0,b.jsxs)(n.Z,{variant:"body2",children:["Notes: ",e.orderNotes]})]},t)})):(0,b.jsx)(n.Z,{variant:"body2",children:"You have no orders."})]})}),(0,b.jsxs)(p.Z,{open:D,onClose:V,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,b.jsx)(g.Z,{id:"alert-dialog-title",children:"Delete Your Account?"}),(0,b.jsx)(j.Z,{children:(0,b.jsx)(v.Z,{id:"alert-dialog-description",children:"Are you sure you want to delete your account? This action cannot be undone."})}),(0,b.jsxs)(y.Z,{children:[(0,b.jsx)(m.Z,{onClick:V,color:"primary",children:"Cancel"}),(0,b.jsx)(m.Z,{onClick:()=>{fetch("http://localhost:8000/api/customer/".concat(t._id),{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"}).then((async t=>{if(!t.ok)throw new Error("Error deleting account");await e(),T("/")})).catch((e=>console.error("Error:",e)))},color:"primary",autoFocus:!0,children:"Confirm"})]})]})]})}}}]);
//# sourceMappingURL=204.f7a969d5.chunk.js.map