"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[204],{4235:function(e,t,r){var n=r(4165),a=r(1413),s=r(5861),o=r(9439),i=r(890),l=r(3400),c=r(7391),d=r(4294),u=r(3239),h=r(2791),m=r(184);t.Z=function(e){var t=e.close,r=e.type,p=e.resetEmail,x=e.startCountdown,f=e.countdown,Z=e.isButtonDisabled,v=(0,h.useState)(p||""),g=(0,o.Z)(v,2),j=g[0],y=g[1],b=(0,h.useState)(""),w=(0,o.Z)(b,2),C=w[0],k=w[1],S=(0,h.useState)(!1),A=(0,o.Z)(S,2),N=A[0],P=A[1],E=(0,h.useState)({}),T=(0,o.Z)(E,2),D=T[0],W=T[1],B=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W({}),""!==j.trim()){e.next=6;break}return W((function(e){return(0,a.Z)((0,a.Z)({},e),{},{email:"Email is required"})})),e.abrupt("return");case 6:if(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(j.trim())){e.next=10;break}return W((function(e){return(0,a.Z)((0,a.Z)({},e),{},{email:"Please enter a valid email address"})})),e.abrupt("return");case 10:return t.preventDefault(),e.prev=11,P(!0),e.next=15,fetch("http://localhost:8000/api/forgot-password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:j})});case 15:return r=e.sent,e.next=18,r.json();case 18:s=e.sent,r.ok&&(P(!1),k(s.message),x()),429===r.status?W({email:r.statusText}):s.errors&&s.errors.email?W({email:s.errors.email}):k(s.message||"Error occurred"),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(11),P(!1),W({message:e.t0.message});case 27:return e.prev=27,P(!1),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[11,23,27,30]])})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"300px",height:"410px",backgroundColor:"white",bgcolor:"background.paper",borderRadius:"5px",border:"0.1px solid black"},children:[(0,m.jsx)(i.Z,{sx:{backgroundColor:"#0F75E0",padding:2,color:"white",pb:2},variant:"h5",align:"center",children:"change"===r?"Reset Password":" Forgot Password"}),(0,m.jsx)(l.Z,{style:{transform:"translate(240px, -60px)",color:"#282F48"},onClick:function(){return t(!1)},children:(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",height:"40",width:"40",children:(0,m.jsx)("path",{d:"m10.458 31.458-1.916-1.916 9.5-9.542-9.5-9.542 1.916-1.916 9.542 9.5 9.542-9.5 1.916 1.916-9.5 9.542 9.5 9.542-1.916 1.916-9.542-9.5Z"})})}),(0,m.jsx)("div",{}),(0,m.jsxs)(i.Z,{mb:4,mt:{sm:-3,md:0},textAlign:"center",variant:"body2",children:["Send a link to reset  ",(0,m.jsx)("br",{}),"  your password"]}),(0,m.jsxs)("div",{style:{padding:10},children:[(0,m.jsx)(c.Z,{id:"email-reset",type:"email",autoComplete:"email",label:"Email Address",disabled:"change"===r,value:"change"===r?p:j,onChange:function(e){return y(e.target.value)},required:!0,fullWidth:!0,error:!!D.email,helperText:D.email||"",name:"email"}),C&&(0,m.jsxs)("h3",{style:{textAlign:"center",color:"#30842E",marginTop:"5px"},children:[C,"!"]}),(0,m.jsx)(d.Z,{variant:"outlined",color:"secondary",fullWidth:!0,onClick:B,disabled:Z||N,type:"submit",sx:{mt:8,height:"50px"},children:N?(0,m.jsx)(u.Z,{size:24}):Z?"Resend Link (".concat(f,")"):"Send Link"})]})]})}},4204:function(e,t,r){r.r(t);var n=r(4942),a=r(1413),s=r(4165),o=r(5861),i=r(9439),l=r(2791),c=r(7689),d=r(9165),u=r(1889),h=r(890),m=r(5527),p=r(4721),x=r(3239),f=r(7391),Z=r(4294),v=r(8447),g=r(6029),j=r(5289),y=r(5661),b=r(9157),w=r(1691),C=r(7123),k=r(2019),S=r(4235),A=r(184);t.default=function(){(0,l.useEffect)((function(){document.title="Your Account Details - Herba Naturals User Profile",document.querySelector('meta[name="description"]').setAttribute("content","Manage your Herba Naturals account details. Update personal information, track orders, and customize your CBD shopping experience.")}),[]);var e=(0,k.a)().deleteUser,t=(0,l.useState)(null),r=(0,i.Z)(t,2),N=r[0],P=r[1],E=(0,l.useState)(!1),T=(0,i.Z)(E,2),D=T[0],W=T[1],B=(0,l.useState)(!1),F=(0,i.Z)(B,2),M=F[0],O=F[1],z=(0,l.useState)({}),L=(0,i.Z)(z,2),U=L[0],H=L[1],V=(0,l.useState)(!1),I=(0,i.Z)(V,2),Y=I[0],q=I[1],R=(0,c.s0)(),$=(0,l.useState)(!1),_=(0,i.Z)($,2),J=_[0],Q=_[1],G=(0,l.useState)(!1),K=(0,i.Z)(G,2),X=K[0],ee=K[1],te=(0,l.useState)(30),re=(0,i.Z)(te,2),ne=re[0],ae=re[1],se=(0,l.useState)(!1),oe=(0,i.Z)(se,2),ie=oe[0],le=oe[1];(0,l.useEffect)((function(){var e=localStorage.getItem("token");if(e){var t=(0,d.o)(e).customerId;de(t)}else R("/login")}),[R]);var ce=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){return fetch("http://localhost:8000/api/order/".concat(e),{credentials:"include"}).then((function(e){return e.json()})).catch((function(t){console.error("Error fetching order:",e,t)}))})));case 2:return r=e.sent,e.abrupt("return",r.filter((function(e){return null!=e})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var r,n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.prev=1,e.next=4,fetch("http://localhost:8000/api/customer/".concat(t),{credentials:"include"});case 4:if((r=e.sent).ok){e.next=7;break}throw new Error("Network response was not ok");case 7:return e.next=9,r.json();case 9:if(n=e.sent,P(n),!(n.orders&&n.orders.length>0)){e.next=16;break}return e.next=14,ce(n.orders);case 14:o=e.sent,P((function(e){return(0,a.Z)((0,a.Z)({},e),{},{orders:o})}));case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.error("Error fetching customer data:",e.t0);case 21:return e.prev=21,O(!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[1,18,21,24]])})));return function(t){return e.apply(this,arguments)}}(),ue=function(e){P((0,a.Z)((0,a.Z)({},N),{},(0,n.Z)({},e.target.name,e.target.value))),q(!0)},he=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var r,n,a,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),H({}),W(!0),e.prev=3,e.next=6,fetch("http://localhost:8000/api/customer/".concat(N._id),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(N)});case 6:if((r=e.sent).ok){e.next=15;break}return e.next=10,r.json();case 10:n=e.sent,console.error("Error updating customer data:",n),"Validation error"===n.message&&n.error&&(a={},Object.keys(n.error.errors).forEach((function(e){console.error("Validation error for ".concat(e,": ").concat(n.error.errors[e].message)),a[e]=n.error.errors[e].message})),H(a),W(!1)),e.next=22;break;case 15:return e.next=17,r.json();case 17:o=e.sent,P(o),W(!1),q(!1),window.alert("Account Succssfully Updated!");case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(3),console.error("Unknown error occurred:",e.t0);case 27:return e.prev=27,W(!1),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[3,24,27,30]])})));return function(t){return e.apply(this,arguments)}}(),me=function(){Q(!1)};return M?(0,A.jsx)(m.Z,{sx:{p:2,maxWidth:800,margin:"0 auto",marginTop:4},children:(0,A.jsxs)(h.Z,{variant:"h5",sx:{marginBottom:2},children:["Loading Account Details...",(0,A.jsx)(x.Z,{})]})}):(0,A.jsxs)(m.Z,{sx:{p:4,maxWidth:800,margin:"0px auto",marginTop:5,marginBottom:5},children:[(0,A.jsx)(h.Z,{variant:"h1",component:"h1",sx:{marginBottom:2,fontSize:"h5.fontSize"},children:"Account Details"}),(0,A.jsxs)("form",{onSubmit:he,children:[(0,A.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,A.jsx)(u.ZP,{item:!0,xs:12,sm:6,children:(0,A.jsx)(f.Z,{autoComplete:"given-name",name:"firstName",label:"First Name",fullWidth:!0,value:(null===N||void 0===N?void 0:N.firstName)||"",onChange:ue,error:!!U.firstName,helperText:U.firstName})}),(0,A.jsx)(u.ZP,{item:!0,xs:12,sm:6,children:(0,A.jsx)(f.Z,{label:"Last Name",fullWidth:!0,autoComplete:"family-name",name:"lastName",value:(null===N||void 0===N?void 0:N.lastName)||"",onChange:ue,error:!!U.lastName,helperText:U.lastName})}),(0,A.jsx)(u.ZP,{item:!0,xs:12,children:(0,A.jsx)(f.Z,{label:"Email",fullWidth:!0,autoComplete:"email",type:"email",id:"email",name:"email",value:(null===N||void 0===N?void 0:N.email)||"",onChange:ue,error:!!U.email,helperText:U.email?U.email:(0,A.jsxs)("span",{children:[(0,A.jsx)("svg",{height:"16",fill:"#0F75E0",style:{transform:"translateY(3px)"},viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM11 7H13V9H11V7ZM11 11H13V17H11V11Z"})})," This will change the email associated with your account"]})})}),(0,A.jsx)(u.ZP,{item:!0,xs:12,children:(0,A.jsx)(f.Z,{label:"Address",fullWidth:!0,name:"address1",autoComplete:"address-line1",value:(null===N||void 0===N?void 0:N.address)||"",onChange:ue})}),(0,A.jsx)(u.ZP,{item:!0,xs:12,children:(0,A.jsx)(f.Z,{label:"Address Line 2",fullWidth:!0,autoComplete:"address-line2",name:"address2",value:(null===N||void 0===N?void 0:N.address2)||"",onChange:ue})}),(0,A.jsx)(u.ZP,{item:!0,xs:12,sm:6,children:(0,A.jsx)(f.Z,{label:"City",fullWidth:!0,name:"city",autoComplete:"address-level2",value:(null===N||void 0===N?void 0:N.city)||"",onChange:ue})}),(0,A.jsx)(u.ZP,{item:!0,xs:12,sm:6,children:(0,A.jsx)(f.Z,{label:"State",fullWidth:!0,name:"state",autoComplete:"address-level1",value:(null===N||void 0===N?void 0:N.state)||"",onChange:ue})}),(0,A.jsx)(u.ZP,{item:!0,xs:12,sm:6,children:(0,A.jsx)(f.Z,{label:"Zip",fullWidth:!0,name:"zip",autoComplete:"postal-code",value:(null===N||void 0===N?void 0:N.zip)||"",onChange:ue})}),(0,A.jsx)(u.ZP,{item:!0,xs:12,sm:6,children:(0,A.jsx)(f.Z,{label:"Phone",fullWidth:!0,name:"phone",type:"tel",autoComplete:"tel",value:(null===N||void 0===N?void 0:N.phone)||"",onChange:ue})}),(0,A.jsx)(u.ZP,{item:!0,xs:12,children:(0,A.jsx)(f.Z,{autoComplete:"country-name",label:"Country",fullWidth:!0,name:"country",value:(null===N||void 0===N?void 0:N.country)||"",onChange:ue})}),(0,A.jsxs)(u.ZP,{item:!0,xs:12,children:[(0,A.jsx)(h.Z,{variant:"body2",align:"center",mt:2,children:(0,A.jsx)(Z.Z,{type:"button",onClick:function(){return ee(!0)},color:"primary",children:"Change your password?"})}),(0,A.jsx)(v.Z,{open:X,onClose:function(){return ee(!1)},"aria-labelledby":"forgot-password-modal","aria-describedby":"forgot-password-form",children:(0,A.jsx)("div",{children:(0,A.jsx)(S.Z,{close:ee,type:"change",resetEmail:null===N||void 0===N?void 0:N.email,startCountdown:function(){le(!0),ae(30);var e=setInterval((function(){ae((function(t){return t<=1?(clearInterval(e),le(!1),0):t-1}))}),1e3)},isButtonDisabled:ie,countdown:ne})})}),(0,A.jsx)("h4",{style:{textAlign:"center",marginTop:"20px"},children:"Your Orders:"})]}),N&&N.orders&&N.orders.length>0?N.orders.map((function(e,t){return(0,A.jsxs)(m.Z,{sx:{padding:2,marginBottom:3},children:[(0,A.jsxs)(h.Z,{variant:"h6",children:["Order #",e.orderNumber]}),(0,A.jsxs)(h.Z,{variant:"body2",children:["Order Date: ",e.orderDate?new Date(e.orderDate).toLocaleDateString():"N/A"]}),(0,A.jsxs)(h.Z,{variant:"body2",children:["Total Amount: $",e.totalAmount?e.totalAmount.grandTotal.toFixed(2):"N/A"]}),(0,A.jsxs)(h.Z,{variant:"body2",children:["Order Status: ",e.orderStatus||"Unknown"]}),(0,A.jsxs)(h.Z,{variant:"body2",children:["Payment Status: ",e.paymentStatus||"N/A"]}),(0,A.jsx)(p.Z,{sx:{my:2}}),e.products&&e.products.length>0?e.products.map((function(e,t){return function(e){return(0,A.jsxs)(u.ZP,{container:!0,spacing:1,sx:{marginBottom:1},children:[(0,A.jsx)(u.ZP,{item:!0,xs:3,children:(0,A.jsx)("img",{src:e.img,alt:e.name,style:{width:"100%",height:"auto"}})}),(0,A.jsxs)(u.ZP,{item:!0,xs:9,children:[(0,A.jsx)(h.Z,{variant:"subtitle2",children:e.name}),(0,A.jsxs)(h.Z,{variant:"body2",children:["Price: $",e.price?e.price.toFixed(2):"N/A"]}),(0,A.jsxs)(h.Z,{variant:"body2",children:["Quantity: ",e.quantity||"N/A"]})]})]},e)}(e)})):(0,A.jsx)(h.Z,{variant:"body2",children:"No products in this order."}),(0,A.jsx)(p.Z,{sx:{my:2}}),e.shippingMethod&&(0,A.jsxs)(h.Z,{variant:"body2",children:["Shipping Method: ",e.shippingMethod.name]}),(0,A.jsxs)(h.Z,{variant:"body2",children:["Address: ",e.address||"N/A"]}),e.orderNotes&&(0,A.jsxs)(h.Z,{variant:"body2",children:["Notes: ",e.orderNotes]})]},t)})):(0,A.jsx)(h.Z,{variant:"body2",children:"You have no orders."})]}),(0,A.jsxs)(g.Z,{sx:{marginTop:2,height:"90px",display:"flex",justifyContent:"space-between",alignItems:"center",flexDirection:{xs:"column",sm:"row"}},children:[(0,A.jsx)(Z.Z,{style:{width:"210px"},disabled:D||!Y,variant:"contained",color:"primary",type:"submit",children:D?(0,A.jsx)(x.Z,{size:24}):"Save Changes"}),(0,A.jsx)(Z.Z,{style:{width:"210px"},variant:"contained",color:"error",onClick:function(){Q(!0)},children:"Delete Account"})]})]}),(0,A.jsxs)(j.Z,{open:J,onClose:me,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,A.jsx)(y.Z,{id:"alert-dialog-title",children:"Delete Your Account?"}),(0,A.jsx)(b.Z,{children:(0,A.jsx)(w.Z,{id:"alert-dialog-description",children:"Are you sure you want to delete your account? This action cannot be undone."})}),(0,A.jsxs)(C.Z,{children:[(0,A.jsx)(Z.Z,{onClick:me,color:"primary",children:"Cancel"}),(0,A.jsx)(Z.Z,{onClick:function(){fetch("http://localhost:8000/api/customer/".concat(N._id),{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(){var t=(0,o.Z)((0,s.Z)().mark((function t(r){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.ok){t.next=2;break}throw new Error("Error deleting account");case 2:return t.next=4,e();case 4:R("/");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){return console.error("Error:",e)}))},color:"primary",autoFocus:!0,children:"Confirm"})]})]})]})}}}]);
//# sourceMappingURL=204.61e86478.chunk.js.map